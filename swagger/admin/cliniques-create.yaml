openapi: 3.0.0
info:
  title: Admin Clinic Creation API
  description: Cr√©ation de nouvelles cliniques par les administrateurs
  version: 1.0.0

paths:
  /v1/admin/cliniques:
    post:
      tags:
        - Administration
      summary: Cr√©er une nouvelle clinique
      description: |
        Permet aux administrateurs de cr√©er une nouvelle clinique dans le syst√®me.
        
        **üè• Fonctionnalit√©s :**
        - ‚úÖ **Validation compl√®te** : V√©rification d'unicit√© (nom, email)
        - üó∫Ô∏è **G√©olocalisation** : Support des coordonn√©es GPS optionnelles
        - üìÖ **Horaires flexibles** : Configuration des heures d'ouverture par jour
        - üè• **Services m√©dicaux** : Liste des services offerts
        - üìä **Tra√ßabilit√©** : Historique des actions admin
        
        **üìã Donn√©es configurables :**
        
        **Informations de base** (requises) :
        - Nom de la clinique (unique par ville)
        - Adresse compl√®te et ville
        
        **Informations optionnelles** :
        - T√©l√©phone et email de contact
        - Coordonn√©es GPS (latitude/longitude)
        - Horaires d'ouverture par jour de semaine
        - Services m√©dicaux propos√©s
        
        **üîÑ Workflow :**
        1. Admin fournit les informations de la clinique
        2. Syst√®me valide l'unicit√© du nom dans la ville
        3. Validation de l'email si fourni
        4. Validation des horaires et services
        5. Cr√©ation en base avec statut actif
        6. R√©ponse avec ID g√©n√©r√© et statistiques
        
        **‚ö†Ô∏è Contraintes de s√©curit√© :**
        - Nom unique par ville pour √©viter confusions
        - Email unique sur toute la plateforme
        - Validation stricte des horaires et services
        - Coordonn√©es GPS coh√©rentes (latitude ET longitude)
        
        **User Stories :** Admin-US6 (Gestion des cliniques)

      security:
        - bearerAuth: []
      
      requestBody:
        required: true
        description: |
          **Cr√©ation compl√®te** : Nom et adresse sont obligatoires, autres champs optionnels.
          
          ‚ö†Ô∏è **IMPORTANT** : Seuls nom et adresse sont requis, tous les autres champs sont optionnels.
        content:
          application/json:
            schema:
              type: object
              properties:
                # === DONN√âES OBLIGATOIRES ===
                nom:
                  type: string
                  minLength: 3
                  maxLength: 200
                  description: |
                    Nom officiel de la clinique
                    
                    **‚ö†Ô∏è Unicit√© requise** : V√©rifi√© par ville
                    **Contraintes :**
                    - 3-200 caract√®res
                    - Unique dans la ville sp√©cifi√©e
                  example: "Clinique Internationale d'Abidjan"
                
                adresse:
                  type: string
                  minLength: 10
                  maxLength: 1000
                  description: |
                    Adresse compl√®te de la clinique
                    
                    **Format recommand√© :**
                    Num√©ro, rue, quartier, r√©f√©rences g√©ographiques
                  example: "Boulevard de la R√©publique, Plateau, en face de la cath√©drale Saint-Paul"
                
                # === DONN√âES OPTIONNELLES ===
                ville:
                  type: string
                  minLength: 2
                  maxLength: 100
                  description: |
                    Ville d'implantation de la clinique
                    
                    **Par d√©faut :** Abidjan (si non sp√©cifi√©)
                    **Usage :** Utilis√© pour v√©rifier l'unicit√© du nom
                  example: "Abidjan"
                
                telephone:
                  type: string
                  pattern: '^(\+225|0)[0-9]{8,10}$'
                  description: |
                    Num√©ro de t√©l√©phone principal de la clinique
                    
                    **Formats accept√©s :**
                    - `+225XXXXXXXX` (international)
                    - `0XXXXXXXXX` (national)
                  example: "+22521234567"
                
                email:
                  type: string
                  format: email
                  maxLength: 255
                  description: |
                    Adresse email de contact de la clinique
                    
                    **‚ö†Ô∏è Unicit√© requise** : V√©rifi√© sur toute la plateforme
                    **Usage :** Contact administratif et communications
                  example: "contact@clinique-abidjan.ci"
                
                # === G√âOLOCALISATION ===
                latitude:
                  type: number
                  minimum: -90
                  maximum: 90
                  description: |
                    Latitude GPS de la clinique
                    
                    **‚ö†Ô∏è Requis avec longitude** : Les deux coordonn√©es doivent √™tre fournies ensemble
                    **Usage :** G√©olocalisation pour patients, calcul distances
                  example: 5.3157
                
                longitude:
                  type: number
                  minimum: -180
                  maximum: 180
                  description: |
                    Longitude GPS de la clinique
                    
                    **‚ö†Ô∏è Requis avec latitude** : Les deux coordonn√©es doivent √™tre fournies ensemble
                    **Usage :** G√©olocalisation pour patients, calcul distances
                  example: -4.0217
                
                # === HORAIRES D'OUVERTURE ===
                horaires:
                  type: object
                  description: |
                    Horaires d'ouverture par jour de la semaine
                    
                    **Structure :** `{ "JOUR": { "ouverture": "HH:mm", "fermeture": "HH:mm" } }`
                    **Jours valides :** LUNDI, MARDI, MERCREDI, JEUDI, VENDREDI, SAMEDI, DIMANCHE
                  properties:
                    LUNDI:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                          example: "08:00"
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                          example: "17:00"
                      required: [ouverture, fermeture]
                    MARDI:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                      required: [ouverture, fermeture]
                    MERCREDI:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                      required: [ouverture, fermeture]
                    JEUDI:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                      required: [ouverture, fermeture]
                    VENDREDI:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                      required: [ouverture, fermeture]
                    SAMEDI:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                      required: [ouverture, fermeture]
                    DIMANCHE:
                      type: object
                      properties:
                        ouverture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                        fermeture:
                          type: string
                          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
                      required: [ouverture, fermeture]
                  example:
                    LUNDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    MARDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    MERCREDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    JEUDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    VENDREDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    SAMEDI: { "ouverture": "09:00", "fermeture": "13:00" }
                
                # === SERVICES M√âDICAUX ===
                services:
                  type: array
                  items:
                    type: string
                    enum:
                      - CONSULTATION_GENERALE
                      - URGENCES
                      - CHIRURGIE
                      - MATERNITE
                      - PEDIATRIE
                      - CARDIOLOGIE
                      - RADIOLOGIE
                      - LABORATOIRE
                      - PHARMACIE
                      - DENTAIRE
                      - OPHTALMOLOGIE
                      - DERMATOLOGIE
                      - GYNECOLOGIE
                      - PSYCHIATRIE
                      - KINESITHERAPIE
                      - DIALYSE
                      - ONCOLOGIE
                  uniqueItems: true
                  description: |
                    Services m√©dicaux propos√©s par la clinique
                    
                    **Usage :** Filtrage pour patients, association m√©decins-services
                    **Validation :** Uniquement les services de la liste officielle
                  example: ["CONSULTATION_GENERALE", "URGENCES", "RADIOLOGIE", "LABORATOIRE"]

              required:
                - nom
                - adresse

            examples:
              clinique_complete:
                summary: Clinique compl√®te avec tous les services
                description: Exemple de cr√©ation d'une clinique avec toutes les informations
                value:
                  nom: "Clinique Internationale d'Abidjan"
                  adresse: "Boulevard de la R√©publique, Plateau, en face de la cath√©drale Saint-Paul"
                  ville: "Abidjan"
                  telephone: "+22521234567"
                  email: "contact@clinique-abidjan.ci"
                  latitude: 5.3157
                  longitude: -4.0217
                  horaires:
                    LUNDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    MARDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    MERCREDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    JEUDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    VENDREDI: { "ouverture": "08:00", "fermeture": "17:00" }
                    SAMEDI: { "ouverture": "09:00", "fermeture": "13:00" }
                  services: ["CONSULTATION_GENERALE", "URGENCES", "RADIOLOGIE", "LABORATOIRE", "PHARMACIE"]
              
              clinique_minimale:
                summary: Clinique avec informations minimales
                description: Exemple de cr√©ation avec seulement les champs obligatoires
                value:
                  nom: "Cabinet M√©dical Dr Kouame"
                  adresse: "Rue des Jardins, Cocody Riviera, pr√®s du march√©"
              
              clinique_avec_gps:
                summary: Clinique avec g√©olocalisation
                description: Exemple incluant les coordonn√©es GPS pour g√©olocalisation
                value:
                  nom: "Polyclinique de Yamoussoukro"
                  adresse: "Avenue Houphou√´t-Boigny, centre-ville"
                  ville: "Yamoussoukro"
                  telephone: "+22530456789"
                  latitude: 6.8205
                  longitude: -5.2767
                  services: ["CONSULTATION_GENERALE", "MATERNITE", "PEDIATRIE"]
              
              clinique_horaires_personnalises:
                summary: Clinique avec horaires sp√©cialis√©s
                description: Exemple avec horaires d'ouverture personnalis√©s
                value:
                  nom: "Clinique des Urgences 24h/24"
                  adresse: "Carrefour Solibra, Yopougon"
                  ville: "Abidjan"
                  telephone: "+22507123456"
                  email: "urgences@clinique24h.ci"
                  horaires:
                    LUNDI: { "ouverture": "00:00", "fermeture": "23:59" }
                    MARDI: { "ouverture": "00:00", "fermeture": "23:59" }
                    MERCREDI: { "ouverture": "00:00", "fermeture": "23:59" }
                    JEUDI: { "ouverture": "00:00", "fermeture": "23:59" }
                    VENDREDI: { "ouverture": "00:00", "fermeture": "23:59" }
                    SAMEDI: { "ouverture": "00:00", "fermeture": "23:59" }
                    DIMANCHE: { "ouverture": "00:00", "fermeture": "23:59" }
                  services: ["URGENCES", "CONSULTATION_GENERALE", "CHIRURGIE"]

      responses:
        '201':
          description: Clinique cr√©√©e avec succ√®s
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Clinique cr√©√©e avec succ√®s"
                  data:
                    type: object
                    properties:
                      clinique:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                            example: "c3d4e5f6-g7h8-9012-cdef-123456789012"
                          nom:
                            type: string
                            example: "Clinique Internationale d'Abidjan"
                          adresse:
                            type: string
                            example: "Boulevard de la R√©publique, Plateau"
                          ville:
                            type: string
                            example: "Abidjan"
                          telephone:
                            type: string
                            nullable: true
                            example: "+22521234567"
                          email:
                            type: string
                            nullable: true
                            example: "contact@clinique-abidjan.ci"
                          latitude:
                            type: number
                            nullable: true
                            example: 5.3157
                          longitude:
                            type: number
                            nullable: true
                            example: -4.0217
                          horaires:
                            type: object
                            nullable: true
                            example: { "LUNDI": { "ouverture": "08:00", "fermeture": "17:00" } }
                          services:
                            type: array
                            nullable: true
                            items:
                              type: string
                            example: ["CONSULTATION_GENERALE", "URGENCES"]
                          active:
                            type: boolean
                            example: true
                          createdAt:
                            type: string
                            format: date-time
                            example: "2024-01-15T14:30:22.123Z"
                      creationInfo:
                        type: object
                        description: Informations sur la cr√©ation
                        properties:
                          createdBy:
                            type: string
                            example: "Admin Marie Kouassi"
                          createdAt:
                            type: string
                            format: date-time
                            example: "2024-01-15T14:30:22.123Z"
                          ip:
                            type: string
                            example: "192.168.1.100"
                      nextSteps:
                        type: array
                        items:
                          type: string
                        description: √âtapes suivantes sugg√©r√©es
                        example: [
                          "La clinique est maintenant active et visible",
                          "Les m√©decins peuvent maintenant s'y associer",
                          "Vous pouvez modifier les informations via PUT /admin/cliniques/:id"
                        ]
                      statistics:
                        type: object
                        description: Statistiques apr√®s cr√©ation
                        properties:
                          totalCliniques:
                            type: integer
                            example: 15
                          nouvelleCliqueAjoutee:
                            type: boolean
                            example: true
                  timestamp:
                    type: string
                    format: date-time
                    example: "2024-01-15T14:30:22.123Z"
              examples:
                clinique_creee:
                  summary: Clinique cr√©√©e avec succ√®s
                  value:
                    success: true
                    message: "Clinique cr√©√©e avec succ√®s"
                    data:
                      clinique:
                        id: "c3d4e5f6-g7h8-9012-cdef-123456789012"
                        nom: "Clinique Internationale d'Abidjan"
                        adresse: "Boulevard de la R√©publique, Plateau"
                        ville: "Abidjan"
                        telephone: "+22521234567"
                        email: "contact@clinique-abidjan.ci"
                        latitude: 5.3157
                        longitude: -4.0217
                        horaires:
                          LUNDI: { "ouverture": "08:00", "fermeture": "17:00" }
                          MARDI: { "ouverture": "08:00", "fermeture": "17:00" }
                        services: ["CONSULTATION_GENERALE", "URGENCES", "RADIOLOGIE"]
                        active: true
                        createdAt: "2024-01-15T14:30:22.123Z"
                      creationInfo:
                        createdBy: "Admin Marie Kouassi"
                        createdAt: "2024-01-15T14:30:22.123Z"
                        ip: "192.168.1.100"
                      nextSteps: [
                        "La clinique est maintenant active et visible",
                        "Les m√©decins peuvent maintenant s'y associer",
                        "Vous pouvez modifier les informations via PUT /admin/cliniques/:id",
                        "Ajoutez des m√©decins via leur profil individuel"
                      ]
                      statistics:
                        totalCliniques: 15
                        nouvelleCliqueAjoutee: true
                    timestamp: "2024-01-15T14:30:22.123Z"

        '400':
          description: Requ√™te invalide - Donn√©es malform√©es ou contraintes viol√©es
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                validation_champs:
                  summary: Erreurs de validation des champs
                  value:
                    success: false
                    error: "VALIDATION_ERROR"
                    message: "Param√®tres de requ√™te invalides"
                    details:
                      nom: "Le nom doit contenir entre 3 et 200 caract√®res"
                      adresse: "L'adresse doit contenir au moins 10 caract√®res"
                    timestamp: "2024-01-15T14:30:22.123Z"
                
                nom_deja_utilise:
                  summary: Nom de clinique d√©j√† utilis√© dans la ville
                  value:
                    success: false
                    error: "BAD_REQUEST"
                    message: "Une clinique avec ce nom existe d√©j√† dans cette ville"
                    details:
                      code: "CLINIQUE_NAME_EXISTS"
                      field: "nom"
                      conflict:
                        nom: "Clinique Internationale"
                        ville: "Abidjan"
                    timestamp: "2024-01-15T14:30:22.123Z"
                
                email_deja_utilise:
                  summary: Email d√©j√† utilis√© par une autre clinique
                  value:
                    success: false
                    error: "BAD_REQUEST"
                    message: "Cette adresse email est d√©j√† utilis√©e"
                    details:
                      code: "EMAIL_ALREADY_EXISTS"
                      field: "email"
                    timestamp: "2024-01-15T14:30:22.123Z"
                
                horaires_invalides:
                  summary: Format d'horaires incorrect
                  value:
                    success: false
                    error: "BAD_REQUEST"
                    message: "Horaires incomplets pour LUNDI"
                    details:
                      code: "INCOMPLETE_HOURS"
                      field: "horaires"
                      day: "LUNDI"
                      required: ["ouverture", "fermeture"]
                    timestamp: "2024-01-15T14:30:22.123Z"
                
                services_invalides:
                  summary: Services non reconnus
                  value:
                    success: false
                    error: "BAD_REQUEST"
                    message: "Services non reconnus"
                    details:
                      code: "INVALID_SERVICES"
                      field: "services"
                      invalidServices: ["SERVICE_INEXISTANT", "AUTRE_SERVICE"]
                      availableServices: ["CONSULTATION_GENERALE", "URGENCES", "CHIRURGIE"]
                    timestamp: "2024-01-15T14:30:22.123Z"
                
                coordonnees_gps_incompletes:
                  summary: Coordonn√©es GPS incompl√®tes
                  value:
                    success: false
                    error: "BAD_REQUEST"
                    message: "Latitude et longitude doivent √™tre fournies ensemble"
                    details:
                      code: "INCOMPLETE_GPS_COORDINATES"
                      message: "Si vous fournissez des coordonn√©es GPS, latitude ET longitude sont requises"
                    timestamp: "2024-01-15T14:30:22.123Z"

        '401':
          $ref: '#/components/responses/Unauthorized'

        '403':
          description: Acc√®s refus√© - R√©serv√© aux administrateurs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                error: "FORBIDDEN"
                message: "Acc√®s r√©serv√© aux administrateurs"
                timestamp: "2024-01-15T14:30:22.123Z"

        '500':
          $ref: '#/components/responses/ServerError'

components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "ERROR_CODE"
        message:
          type: string
          example: "Description de l'erreur"
        details:
          type: object
          additionalProperties: true
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T14:30:22.123Z"

  responses:
    Unauthorized:
      description: Non authentifi√© - Token manquant ou invalide
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error: "UNAUTHORIZED"
            message: "Token d'authentification requis"
            timestamp: "2024-01-15T14:30:22.123Z"

    ServerError:
      description: Erreur interne du serveur
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error: "INTERNAL_SERVER_ERROR"
            message: "Erreur interne lors de la cr√©ation de la clinique"
            timestamp: "2024-01-15T14:30:22.123Z"

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Token JWT d'administrateur obtenu lors de la connexion.
        Format: `Authorization: Bearer <admin_token>`